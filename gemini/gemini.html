<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>ü§ñ Chat Gemini ‚Äì Caverna Robotica</title>
   <link href="style.css" rel="stylesheet" type="text/css">
</head>
<body>
  <div class="container">
    <h2>ü§ñ Gemini Chat </h2>
    <div id="chat"></div>
    <textarea id="prompt" placeholder="Scrivi qualcosa..."></textarea>
    <button id="btnSend">Invia</button>
  </div>

  <script type="module">
    import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";

    // ‚ö†Ô∏è Inserisci qui la tua API Key (solo per test locale!)
    const genAI = new GoogleGenerativeAI("");

    const chat = document.getElementById("chat");
    const btn = document.getElementById("btnSend");
    const promptArea = document.getElementById("prompt");

    // Funzione per aggiungere messaggi alla chat
    function appendMsg(text, who="bot") {
      const div = document.createElement("div");
      div.className = "msg " + who;
      div.innerHTML = `<b>${who === "user" ? "Tu" : "Gemini"}:</b> ${text}`;
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
    }

    // Invio messaggio
    btn.addEventListener("click", async () => {
      const prompt = promptArea.value.trim();
      if (!prompt) return;

      appendMsg(prompt, "user");
      promptArea.value = "";
      appendMsg("<i>Sto elaborando...</i>", "bot");

      try {
        const model = genAI.getGenerativeModel({ model: "gemini-2.5-flash" });
        const result = await model.generateContent(prompt);
        const text = result.response.text();
        chat.lastChild.innerHTML = `<b>Gemini:</b> ${text}`;
      } catch (err) {
        console.error(err);
        chat.lastChild.innerHTML = "<b>Gemini:</b> ‚ö†Ô∏è Errore nel contattare il server.";
      }
    });

    // Invio con Invio ‚Üµ
    promptArea.addEventListener("keydown", e => {
      if (e.key === "Enter" && !e.shiftKey) {
        e.preventDefault();
        btn.click();
      }
    });
  </script>
</body>
</html>
